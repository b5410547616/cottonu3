
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>11street Live | Cotton USA</title>
	<link rel="stylesheet" href="assets/style/normalize.css">
	<link rel="stylesheet" href="assets/style/isobar-style.css">
</head>
<body style="background-color: #eee">

	<div class="isobar-product-feed">
		<ul>

			
			
		</ul>
	</div>

<script src="assets/script/jquery-3.2.1.min.js"></script>	
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io();
  socket.on('news', function (data) {
    console.log(data);
  });
  socket.on('update', (items) => {
  	// console.log("update")
  	updateCart(items);
  });

  function updateCart(items) {
  	let data = "";

    // itemCount.push(items.length);
    // count++;
    // items.map((item) => {
    for (var i = items.length - 1 ; i >= 0; i--) {
    	data = '<li>';
		data += '<a href="http://www.11street.co.th/productdetail/'+items[i].Number+'" target="_blank">';
		data += '<div class="detail-block product-pic">';
		data += '<img src="'+items[i].img+'" alt="">';
		data += '</div>';
		data += '<div class="detail-block product-detail">';
		data += '<div class="product-name">';
		data += '<p>'+items[i].Name+'</p>';
		data += '</div>';

		data += '<div class="product-discount">';
		data += '<p class="discount-percent">'+items[i].Discount+'%</p>';
		data += '<p>off</p>';
		data += '</div>';
		
		data += '<div class="product-price">';
		data += '<p class="normal-price">'+items[i].Price+' à¸¿</p>';
		data += '<p class="deal-price">'+items[i].Finalprice+' à¸¿</p>';
		data += '</div>';

		// data += '<div class="product-discount">';
		// data += '<p class="discount-percent">'+items[i].Discount+'%</p>';
		// data += '<p>off</p>';
		// data += '</div>';

		// data += '<img class="add-product" src="assets/images/buy.png" alt="">';
		data += '</div>';
		data += '</a>';
		data += '</li>';
		$('.isobar-product-feed ul').prepend(data);
	}
    // });	

    // if(count > 3) {
    	// for (var i = 0; i < itemCount[0]; i++) {
    	// 	$('.isobar-product-feed ul li:nth-last-child(1)').remove();
    	// }
    	// itemCount.shift();
    // }
    // console.log(itemCount);
  }

  // var itemCount = [];
  // var count = 0;
  socket.on('clientData', function (items) {
    console.log(items);
    updateCart(items);
  });

  socket.on('resetClient', function() {
  	$('.isobar-product-feed ul').html('');
  	// itemCount = [];
  	// count = 0;
  });

</script>
</body>
</html>